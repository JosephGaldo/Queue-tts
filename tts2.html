<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Queue Voice Announcer</title>
</head>
<body>
  <h1>Now Serving: <span id="display"></span></h1>
  <!-- No need for button, can be removed if you want -->
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const number = urlParams.get('number') || 'R#001';
    const counter = urlParams.get('counter') || '1';

    const messageText = `Now serving ${number} at counter ${counter}`;
    document.getElementById("display").textContent = messageText;

    const announceBtn = document.getElementById('announceBtn');
    let selectedVoice = null;

    function findFemaleVoice() {
      const voices = speechSynthesis.getVoices();
      const femaleVoices = voices.filter(voice => voice.name.toLowerCase().includes('female') || voice.name.toLowerCase().includes('woman') || voice.name.toLowerCase().includes('girl'));
      if (femaleVoices.length > 0) {
        selectedVoice = femaleVoices[0];
      } else if (voices.length > 0) {
        selectedVoice = voices[0];
      }
    }

    function announce() {
      if (!selectedVoice) {
        findFemaleVoice();
      }
      
      // 1 second silence
      const silence = new SpeechSynthesisUtterance('');
      silence.volume = 0;
      silence.lang = 'en-US';

      // The message
      const message = new SpeechSynthesisUtterance(`.. Now Now serving ${number} ${counter}`);
      message.voice = selectedVoice;
      message.lang = 'en-US';

      // Speak silence then message
      speechSynthesis.speak(silence);
      speechSynthesis.speak(message);
    }

    // Automatically run on load without button
    window.onload = () => {
      if (speechSynthesis.getVoices().length > 0) {
        findFemaleVoice();
        announce();
      } else {
        speechSynthesis.onvoiceschanged = () => {
          findFemaleVoice();
          announce();
        };
      }
    };
  </script>
</body>
</html>
